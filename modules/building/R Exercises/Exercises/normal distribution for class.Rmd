---
title: ""
output: html_document
---

# Properties of the normal distribution

The Normal distribution has special properties that are useful for data analyses, which is why the normal distribution is often considered a gold standard for comparison. Each distribution of scores, whether a population or a sample, has a mean ($\mu$) and a variance ($\sigma$^2^) and thus, standard deviation ($\sigma$). The standard normal distribution (z distribution) is a special case of the normal distribution because it has a mean = 0 and a standard deviation = 1. There are, however, other distributions that are normal in shape that have different means and standard deviations. No matter what the mean and standard deviations are of normal distributions, they all have the same characteristics regarding probabilities. For example, IQs follow a normal distribution with a mean = 100 and a standard deviation = 15. Thus, the normal distribution is defined by a probability density function, where the population mean is $\mu$ and the standard deviation is $\sigma$.

Let's create a random data set that adheres to the properties of a normal distribution using the function `rnorm()`. You can find out more about the function by typing `?rnorm` in the command window. The **?** preceding R commands is used to obtain help regarding the command. 

The `rnorm()` function takes 3 arguments that you can supply within the parentheses **()** of the function. 
Example: `rnorm(n=?, mean=?, sd=?)`. 

* sample size (n)
* mean ($\mu$)
* standard devation ($\sigma$)

We can create a random sample of data of 100,000 values with a mean of 100 and a standard deviation of 15. This distribution will represent a distribution of IQ scores that has such parameters. 

```{r}
IQ <- rnorm(n=100000, mean=100, sd=15)
```
We can check that the mean and the standard deviation are close to what we would expect.
```{r}
mean(IQ); sd(IQ)
```

We can plot the data as well using the `hist()` function, which takes your vector variable you wish to plot as the argument.
```{r}
hist(IQ)
```

If we use the lattice library, we can create different graphical displays using the `histogram()` function, which will allow for better customization than the built-in `hist()` function. This function format is `graph_type(formula, data=)`. When you work with vector variables in a data frame, you will assign **data** to your data frame of interest. 

To simulate how you will interact with data later, we can convert the vector varable into a  **data frame** called **mydata** using the `as.data.frame()` function.  This will result in a data frame containing your IQ data. 

```{r}
mydata <- as.data.frame(IQ)
```

We can import the lattice library `library(lattice)` and then plot the **IQ** vector variable from the **mydata** data frame.
```{r}
library(lattice)
histogram(~IQ, data = mydata)
```

Notice that with a large sample size, the random data set results in a symmetric distribution as expected for a normal distribution. Notice that the y-axis is a percent score. By default, `histogram()` plots data as a percentage of overall scores. If we want to plot frequency counts, we can modify the `type` argument and assign it to `count` `type="count"` and the y-axis will reflect frequency counts. For example:

```{r}
histogram(~IQ, data = mydata, type="count")
```

But we can also modify the `type` argument to show us the probability density `type="density"` and change the **breaks** to `breaks = 20` to show a more fine-grained histogram. For the probability density function, each bin reflects a likelihood (probability) of occurring and all events must add up to 1.0. For example:

```{r}
histogram(~IQ, data = mydata, type="density", breaks = 20)
#histogram(~IQ, data = mydata, type="density", xlab="IQ", main="IQ Scores for a sample of 100k")
```

A density plot will be produces using `densityplot()`, although with so many data points, you cannot see how densely packed the data are near the center of the distribution. 

```{r}
densityplot(~IQ, data = mydata)
```

For other options with the histogram function in the lattice package, you can go to  (https://cran.r-project.org/web/packages/tigerstats/vignettes/histogram.html)

# Examining *p* values and the area below some reference point

A *p* value provides information about the likelihood (probability) of events occurring below or above some reference point. If we assume that a population has a mean IQ of 100 and a standard deviation of 15, we can determine the likelihood of  different IQs occurring in the population. Probability values of .05 (5%) or .01 (1%) are typical cutoffs used for determining the rarity of events. For example, events that are obtained in your data, but are less than likely to occur 5% of the time are considered rare. In order to determine the probability of certain IQs, we can use the function `pnorm()`. 

```{r}
#?pnorm
```
Defining 3 arguments in the  `pnorm()` function will evaluate the likelihood of events occurring at or below some reference point. 

* q (value to evaluate)
* mean (mean of the distribution)
* sd (standard deviation of the distribution)


If you know these components of our distribution, you can determine the likelihood of obtaining a value of 0 or lower from a distribution with a mean of 0 and a standard deviation of 1. Because we know that the mean is 0 and the standard normal distribution is symmetric, the mean must split the distribution into two equal parts. Consequently, the likelihood of those values occurring should be `r pnorm(q=0, mean=0, sd=1)` (`r pnorm(q=0, mean=0, sd=1)*100`%). The function will return the probability value, which is `r pnorm(q=0, mean=0, sd=1)`. 

```{r}
pnorm(q = 0, mean = 0, sd = 1) # set the mean to 0 and standard devation to 1.
```

If you do not specify the mean and the standard deviation, `pnorm()` will assume your distribution has a mean = 0 and sd = 1. For example, 

```{r}
pnorm(0) # set the mean to 0 and standard devation to 1.
```

# Evaluating the area under the normal curve between two points

Because `pnorm()` returns a probability associated with values less than a reference point, you can determine the likelihood of events occurring between two values by subracting the returned *p* value from some z score (e.g., +1.0) from that of another z score (e.g., -1.0). 

Thus, you can test the empirical rule (68-95-99) by using 3 z cutoffs.
```{r}
pnorm(q = 1, mean = 0, sd = 1) - pnorm(q = -1, mean = 0, sd = 1) # -1 to +1 SD
pnorm(q = 2, mean = 0, sd = 1) - pnorm(q = -2, mean = 0, sd = 1) # -2 to +2 SD
pnorm(q = 3, mean = 0, sd = 1) - pnorm(q = -3, mean = 0, sd = 1) # -3 to +3 SD
```

You can also see that values less than -3 are unlikely to occur.  
```{r}
pnorm(q = -3, mean = 0, sd = 1)
```

But values less than +3 are quite likely to occur.  
```{r}
pnorm(q = 3, mean = 0, sd = 1)
```

By default, `pnorm()` returns the probability associated with values to the left (lower than) the reference point. By setting the `lower.tail` argumment to `FALSE`, you can obtain the probability of values greater than the reference point.

```{r}
pnorm(q = 3, mean = 0, sd = 1)
```

If you are interested in determining what standarized score corresponds to certain areas under the curve for the standard normal distribution with a mean of 0 and standard deviation of 1, you can use the `qnorm()` function return the value in your distribution corresponding to probabilities.

```{r}
qnorm(0.95, mean = 0, sd = 1) # What is the Z value that corresponds to .95 in the lower tail?
qnorm(0.05, mean = 0, sd = 1) # What is the Z value that corresponds to .05 in the lower tail?

qnorm(0.025, mean = 0, sd = 1) # What is the Z value that corresponds to .05/2 (.025) in the lower tail?
qnorm(0.01, mean = 0, sd = 1) # What is the Z value that corresponds to .01 in the lower tail?
qnorm(0.005, mean = 0, sd = 1) # What is the Z value that corresponds to .01/2 (.005) in the lower tail?
```
Or we can specify a different mean and standard deviation as with IQs: 

```{r}
qnorm(0.025, mean = 100, sd = 15)
qnorm(.975, mean = 100, sd = 15)
```
Because all normal distributions have the same shape, we can as the same questions about normal distributions that are not the standard normal distribution. For example, you could also be less abstract and use the IQ example and see that 50% of the IQ scores are below 100 (the mean) `qnorm(0.5, mean = 100, sd = 15)`, 5% of the IQ scores are below 75.3271 `qnorm(0.05, mean = 100, sd = 15)`, and only 5% of the scores are greater than 124.6728 `qnorm(0.95, mean = 100, sd = 15)`.

```{r}
qnorm(0.5, mean = 100, sd = 15) # What is the IQ score that corresponds to .50 in the lower tail?
qnorm(0.05, mean = 100, sd = 15) # What is the IQ score that corresponds to .95 in the lower tail?
qnorm(0.95, mean = 100, sd = 15) # What is the IQ score that corresponds to .95 in the lower tail?
```
```{r echo=F}
#$Z = \frac{\bar{x} - \mu_0}{\sigma / \sqrt{n}}$
```